<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>更新日志</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>更新日志 & 个人目标日历</h1>
  <div id="calendar"></div>
  <div id="log-detail" style="display:none;max-width:420px;margin:20px auto 0 auto;background:#fff;border:1px solid #ccc;padding:16px;box-shadow:0 2px 12px #0001;">
    <h3 id="log-date"></h3>
    <textarea id="log-text" rows="4" style="width:100%;"></textarea>
    <div style="margin-top:10px;text-align:right;">
      <button onclick="saveLog()">保存</button>
      <button onclick="closeLog()">关闭</button>
    </div>
  </div>
  <a href="index.html">返回首页</a>
  <style>
    #calendar { max-width: 420px; margin: 30px auto; }
    .calendar-table { border-collapse: collapse; width: 100%; background: #fafbfc; }
    .calendar-table th, .calendar-table td { border: 1px solid #eee; width: 14.2%; height: 48px; text-align: center; cursor: pointer; position: relative; }
    .calendar-table th { background: #f0f0f0; }
    .calendar-table td.log-past { background: #b6eec7; font-weight: bold; }
    .calendar-table td.log-future { background: #5ec98c; color: #fff; font-weight: bold; }
    .calendar-table td.today { border: 2px solid #337ab7; }
    .calendar-table td:hover { background: #d0eaff; }
    #log-detail textarea { font-size: 15px; }
  </style>
  <script>
    // 日志数据，格式：{"2025-12-01": "预计更新个人简历"}
    let logs = {
      "2025-11-29": "图片自适应优化，添加右侧导航栏，zxp下方增加更新说明。",
      "2025-12-01": "预计更新个人简历"
    };
    let currentYear, currentMonth;
    function renderCalendar(year, month) {
      currentYear = year; currentMonth = month;
      const now = new Date();
      const firstDay = new Date(year, month, 1);
      const lastDay = new Date(year, month + 1, 0);
      let html = `<div style="text-align:center;margin-bottom:8px;">
        <button onclick="changeMonth(-1)">上月</button>
        <span style="margin:0 10px;font-weight:bold;font-size:18px;">${year}年${month+1}月</span>
        <button onclick="changeMonth(1)">下月</button>
      </div>`;
      html += '<table class="calendar-table"><tr>';
      const weekDays = ['日','一','二','三','四','五','六'];
      for (let d of weekDays) html += `<th>${d}</th>`;
      html += '</tr><tr>';
      for (let i = 0; i < firstDay.getDay(); i++) html += '<td></td>';
      for (let d = 1; d <= lastDay.getDate(); d++) {
        let dateStr = `${year}-${String(month+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
        let classes = [];
        if (logs[dateStr]) {
          // 判断是过去还是未来
          let dateObj = new Date(year, month, d);
          let todayObj = new Date(now.getFullYear(), now.getMonth(), now.getDate());
          if (dateObj < todayObj) {
            classes.push('log-past');
          } else {
            classes.push('log-future');
          }
        }
        if (dateStr === `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}-${String(now.getDate()).padStart(2,'0')}`) classes.push('today');
        html += `<td class="${classes.join(' ')}" onclick="showLog('${dateStr}')">${d}${logs[dateStr]?'<span style=\'display:block;font-size:10px;color:#b97;\'>●</span>':''}</td>`;
        if ((firstDay.getDay() + d) % 7 === 0) html += '</tr><tr>';
      }
      for (let i = lastDay.getDay(); i < 6; i++) html += '<td></td>';
      html += '</tr></table>';
      document.getElementById('calendar').innerHTML = html;
    }
    function changeMonth(offset) {
      let y = currentYear, m = currentMonth + offset;
      if (m < 0) { y--; m = 11; }
      if (m > 11) { y++; m = 0; }
      renderCalendar(y, m);
    }
    function showLog(dateStr) {
      document.getElementById('log-date').innerText = dateStr;
      document.getElementById('log-text').value = logs[dateStr] || '';
      document.getElementById('log-detail').style.display = 'block';
      document.getElementById('log-text').focus();
    }
    function closeLog() {
      document.getElementById('log-detail').style.display = 'none';
    }
    function saveLog() {
      const dateStr = document.getElementById('log-date').innerText;
      const val = document.getElementById('log-text').value.trim();
      if (val) logs[dateStr] = val;
      else delete logs[dateStr];
      closeLog();
      renderCalendar(currentYear, currentMonth);
    }
    // 初始化
    window.onload = function() {
      const now = new Date();
      renderCalendar(now.getFullYear(), now.getMonth());
    }
  </script>
</body>
</html>